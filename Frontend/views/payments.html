<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payments - Bilal Accounting System (BAS)</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Desktop Style -->
    <link href="/css/desktop-style.css" rel="stylesheet">
    <style>
        /* Split layout for payments */
        .payment-layout {
            display: flex;
            gap: 15px;
        }

        .payment-left {
            width: 400px;
            flex-shrink: 0;
        }

        .payment-right {
            flex: 1;
            min-width: 0;
        }

        .cash-display {
            background: #000;
            color: #00FF00;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
            text-align: center;
        }

        .cash-display label {
            color: #00FF00;
            font-size: 14px;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .cash-display .amount {
            font-size: 28px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }

        .payment-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .payment-tab {
            flex: 1;
            padding: 10px;
            background: var(--form-beige);
            border: 2px solid var(--border-gray);
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
        }

        .payment-tab.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .payment-tab:hover {
            border-color: var(--primary-blue);
        }

        .transaction-history {
            background: white;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid var(--border-gray);
            max-height: 500px;
            overflow-y: auto;
        }

        .balance-display {
            background: var(--calc-blue);
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
        }

        @media (max-width: 1200px) {
            .payment-layout {
                flex-direction: column;
            }

            .payment-left {
                width: 100%;
            }
        }

        /* Mobile Specific Overrides */
        @media (max-width: 768px) {
            .page-header {
                flex-direction: column;
                align-items: stretch !important;
                height: auto;
                padding: 10px;
                gap: 10px;
            }

            .page-header>div {
                flex: none !important;
                width: 100%;
                text-align: center !important;
                margin-bottom: 5px;
            }

            .user-info {
                justify-content: center !important;
            }

            .payment-tabs {
                flex-wrap: wrap;
            }

            .payment-tab {
                min-width: 45%;
                font-size: 14px;
            }

            .form-row {
                flex-wrap: wrap;
                gap: 10px;
            }

            .form-field {
                min-width: 100% !important;
                width: 100% !important;
                margin-right: 0 !important;
                margin-bottom: 10px;
            }

            .input-group {
                width: 100%;
            }

            .action-bar {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 5px;
                padding: 5px;
                left: 0 !important;
                width: 100%;
            }

            .action-bar button {
                flex: 1 1 30%;
                font-size: 12px;
                padding: 8px 5px;
            }

            .transaction-history .d-flex {
                flex-direction: column;
                align-items: stretch !important;
            }

            .transaction-history .d-flex>div {
                margin-top: 10px;
                display: flex;
                flex-wrap: wrap;
                gap: 5px;
            }

            .transaction-history input[type="date"] {
                width: 45% !important;
                flex: 1;
            }

            .transaction-history .data-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>

<body>
    <!-- Page Header -->
    <div class="page-header px-3">
        <div style="flex: 1; display: flex; align-items: center;">
            <i class="fas fa-bars me-3" id="sidebarToggle" style="cursor:pointer; font-size: 1rem;"></i>
            <i class="fas fa-money-bill-wave me-2"></i>
            <span id="pageTitle">Supplier Payments</span>
        </div>
        <div style="flex: 1; display: flex; justify-content: flex-end; align-items: center;">
            <div class="dropdown">
                <div class="d-flex align-items-center text-white" data-bs-toggle="dropdown" style="cursor: pointer;">
                    <i class="fas fa-user-circle me-2" style="font-size: 1.2rem;"></i>
                    <span id="userName" class="me-2">User</span>
                    <i class="fas fa-chevron-down" style="font-size: 0.7rem;"></i>
                </div>
                <ul class="dropdown-menu dropdown-menu-end shadow-sm">
                    <li><a class="dropdown-item logout-btn" href="#"><i
                                class="fas fa-sign-out-alt me-2 text-danger"></i>Sign Out</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="desktop-container">
        <div class="content-wrapper">
            <!-- Payment Tabs -->
            <div class="payment-tabs">
                <div class="payment-tab active" onclick="switchTab('supplier')">
                    <i class="fas fa-truck me-2"></i>Supplier Payments
                </div>
                <div class="payment-tab" onclick="switchTab('customer')">
                    <i class="fas fa-users me-2"></i>Customer Payments
                </div>
            </div>

            <!-- Cash In Hand Display -->
            <div class="cash-display">
                <label>Cash In Hand</label>
                <div class="amount" id="cashInHand">0.00</div>
            </div>

            <!-- Form Section -->
            <div class="form-section">
                <form id="paymentForm">
                    <input type="hidden" id="paymentId">
                    <input type="hidden" id="paymentType" value="supplier">

                    <div class="payment-layout">
                        <!-- Left Section - Payment Form -->
                        <div class="payment-left">
                            <!-- Row 1: Voucher No, Date -->
                            <div class="form-row">
                                <div class="form-field w-150">
                                    <label>Voucher No</label>
                                    <input type="text" id="voucherNo" readonly>
                                </div>
                                <div class="form-field flex-1">
                                    <label class="required">Date</label>
                                    <input type="date" id="paymentDate" required>
                                </div>
                            </div>

                            <!-- Row 2: Party -->
                            <div class="form-row">
                                <div class="form-field flex-1">
                                    <label class="required" id="partyLabel">Supplier</label>
                                    <div class="input-group">
                                        <select id="party" required>
                                            <option value="">-- Select Supplier --</option>
                                        </select>
                                        <button type="button" class="btn-add-new" onclick="showPartyList()">
                                            <i class="fas fa-list"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Balance Display -->
                            <div class="balance-display">
                                <span id="balanceLabel">Pre Balance:</span>
                                <span id="preBalance">0.00</span>
                            </div>

                            <!-- Row 3: Amount -->
                            <div class="form-row">
                                <div class="form-field flex-1">
                                    <label class="required">Amount</label>
                                    <input type="number" id="amount" step="0.01" required>
                                </div>
                            </div>

                            <!-- Row 4: Payment Mode -->
                            <div class="form-row">
                                <div class="form-field flex-1">
                                    <label>Payment Mode</label>
                                    <select id="paymentMode">
                                        <option value="cash">Cash</option>
                                        <option value="bank">Bank</option>
                                        <option value="cheque">Cheque</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Row 5: Bank Details (shown when bank/cheque selected) -->
                            <div id="bankDetails" style="display: none;">
                                <div class="form-row">
                                    <div class="form-field flex-1">
                                        <label>Bank Name</label>
                                        <input type="text" id="bankName">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-field flex-1">
                                        <label>Cheque/Ref No</label>
                                        <input type="text" id="referenceNo">
                                    </div>
                                </div>
                            </div>

                            <!-- Row 6: Remarks -->
                            <div class="form-row">
                                <div class="form-field flex-1">
                                    <label>Remarks</label>
                                    <textarea id="remarks" rows="3"></textarea>
                                </div>
                            </div>

                            <!-- New Balance Display -->
                            <div class="balance-display">
                                <span id="newBalanceLabel">New Balance:</span>
                                <span id="newBalance">0.00</span>
                            </div>
                        </div>

                        <!-- Right Section - Transaction History -->
                        <div class="payment-right">
                            <div class="transaction-history">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h6 class="mb-0">Transaction History</h6>
                                    <div>
                                        <input type="date" class="form-control form-control-sm" id="filterStartDate"
                                            style="display: inline-block; width: 140px;">
                                        <input type="date" class="form-control form-control-sm" id="filterEndDate"
                                            style="display: inline-block; width: 140px;">
                                        <button class="btn btn-sm btn-primary" onclick="filterTransactions()">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>

                                <table class="data-table" id="transactionsTable">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Voucher #</th>
                                            <th>Party</th>
                                            <th class="text-right">Amount</th>
                                            <th>Mode</th>
                                            <th class="text-center">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="transactionsBody">
                                        <tr>
                                            <td colspan="6" class="text-center">No transactions found</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- Pagination -->
                                <div id="pagination" class="mt-3"></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Action Bar -->
    <div class="action-bar">
        <button class="btn btn-success" onclick="savePayment()" data-action="save">
            <i class="fas fa-save"></i> Save
        </button>
        <button class="btn btn-primary" onclick="printVoucher()">
            <i class="fas fa-print"></i> Print
        </button>
        <button class="btn btn-danger" onclick="clearForm()">
            <i class="fas fa-times"></i> Close
        </button>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/pageAccess.js"></script>
    <script src="/js/desktop-ui.js?v=4"></script>
    <script src="/js/payments.js?v=4"></script>
</body>

</html>