<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cash Counter Sale</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/desktop-style.css" rel="stylesheet">
    <link href="/css/sidebar.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            flex: 1;
        }

        .header-center {
            flex: 1;
            text-align: center;
        }

        .header-right {
            flex: 1;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .form-label {
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 2px;
        }

        .form-control-sm,
        .form-select-sm {
            font-size: 0.85rem;
            padding: 4px 6px;
        }

        .blue-header {
            background: #0069d9;
            color: white;
            padding: 5px 10px;
            font-weight: bold;
        }

        .gray-bg {
            background: #e9ecef;
        }

        .main-card {
            border: 1px solid #ddd;
            background: white;
            padding: 15px;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <div class="page-header px-3">
        <div style="flex: 1; display: flex; align-items: center;">
            <i class="fas fa-bars me-3" id="sidebarToggle" style="cursor:pointer; font-size: 1rem;"></i>
            <i class="fas fa-cash-register me-2"></i> Cash Counter Sale
        </div>
        <div style="flex: 1; display: flex; justify-content: flex-end; align-items: center;">
            <div class="dropdown">
                <div class="d-flex align-items-center text-white" data-bs-toggle="dropdown" style="cursor: pointer;">
                    <i class="fas fa-user-circle me-2" style="font-size: 1.2rem;"></i>
                    <span id="userName" class="me-2">User</span>
                    <i class="fas fa-chevron-down" style="font-size: 0.7rem;"></i>
                </div>
                <ul class="dropdown-menu dropdown-menu-end shadow-sm">
                    <li><a class="dropdown-item logout-btn" href="#"><i
                                class="fas fa-sign-out-alt me-2 text-danger"></i>Sign Out</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container-fluid p-3">
        <div class="main-card">
            <!-- Row 1 -->
            <div class="row g-3 mb-3">
                <div class="col-md-2">
                    <label class="form-label">Date</label>
                    <input type="date" id="date" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label class="form-label">Branch</label>
                    <select id="branch" class="form-select form-select-sm">
                        <option value="">Select Branch</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Mode</label>
                    <select id="mode" class="form-select form-select-sm">
                        <option value="Cash">Cash</option>
                        <option value="Bank">Bank</option>
                    </select>
                </div>
            </div>

            <!-- Row 2 -->
            <div class="row g-3 mb-4">
                <div class="col-md-3">
                    <label class="form-label">Department</label>
                    <select id="department" class="form-select form-select-sm">
                        <option value="">Select Department</option>
                    </select>
                </div>
                <div class="col-md-3" id="cashCounterContainer">
                    <label class="form-label">Cash Counter</label>
                    <select id="cashCounter" class="form-select form-select-sm">
                        <option value="Select Cash Counter">Select Cash Counter</option>
                        <option value="Counter 1">Counter 1</option>
                        <option value="Counter 2">Counter 2</option>
                    </select>
                </div>
            </div>
            <!-- Bank Selection (Hidden by default) -->
            <div class="col-md-3" id="bankContainer" style="display:none;">
                <label class="form-label">Bank</label>
                <select id="bankSelect" class="form-select form-select-sm">
                    <option value="">Select Bank</option>
                </select>
            </div>
        </div>

        <!-- Deduction Fields (Hidden by default) -->
        <div class="row g-3 mb-3" id="deductionFields" style="display:none;">
            <div class="col-md-3">
                <label class="form-label">Deducted Amount</label>
                <input type="number" id="deductedAmount" class="form-control form-control-sm" value="0">
            </div>
            <div class="col-md-3 d-flex align-items-end">
                <div class="form-check mb-1">
                    <input class="form-check-input" type="checkbox" id="deductionCheck" checked>
                    <label class="form-check-label" for="deductionCheck">Deduction</label>
                </div>
            </div>
        </div>

        <!-- Sales Table -->
        <div class="table-responsive mb-2" style="max-height: 400px; overflow-y: auto;">
            <table class="table table-bordered table-sm mb-0">
                <thead class="table-primary text-white sticky-top" style="z-index: 1;">
                    <tr class="text-center">
                        <th style="width: 45%;" id="invoiceHeader">Invoice No</th>
                        <th style="width: 45%;">Sales</th>
                        <th style="width: 10%;">Action</th>
                    </tr>
                </thead>
                <tbody id="salesTableBody">
                </tbody>
            </table>
        </div>

        <!-- Total Row -->
        <div class="row g-0 mb-4">
            <div class="col-6 pt-1 fw-bold">Total Amount</div>
            <div class="col-6">
                <input type="number" id="totalAmount" class="form-control form-control-sm gray-bg" readonly
                    value="0.00">
            </div>
        </div>

        <div class="d-flex gap-2">
            <button class="btn btn-success" onclick="saveSale()"><i class="fas fa-save"></i> Save</button>
            <button class="btn btn-info text-white" onclick="printSale()"><i class="fas fa-print"></i>
                Print</button>
            <button class="btn btn-warning text-white" onclick="showList()"><i class="fas fa-list"></i>
                List</button>
            <button class="btn btn-danger" onclick="clearForm()"><i class="fas fa-times"></i> Clear</button>
        </div>

    </div>

    <!-- List Modal -->
    <div class="modal fade" id="listModal" tabindex="-1">
        <div class="modal-dialog modal-fullscreen modal-dialog-scrollable" style="height: 50vh !important;">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white py-2">
                    <h5 class="modal-title fs-6">Cash Sale List</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body bg-light design-list-body">
                    <!-- Filters -->
                    <div class="row g-2 align-items-center mb-3 p-2 bg-white rounded shadow-sm">
                        <div class="col-auto"><label class="fw-bold small">From</label></div>
                        <div class="col-auto"><input type="date" id="listFromDate" class="form-control form-control-sm">
                        </div>
                        <div class="col-auto"><label class="fw-bold small">To</label></div>
                        <div class="col-auto"><input type="date" id="listToDate" class="form-control form-control-sm">
                        </div>
                        <div class="col-auto"><label class="fw-bold small">Branch</label></div>
                        <div class="col-auto">
                            <select id="listBranch" class="form-select form-select-sm" style="min-width: 150px;">
                                <option value="">All Branches</option>
                            </select>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-success btn-sm" onclick="fetchCashSalesList()"><i
                                    class="fas fa-search"></i> Search</button>
                        </div>
                    </div>

                    <div class="table-responsive" style="max-height: 80vh;">
                        <table class="table table-bordered table-sm table-striped table-hover small text-center"
                            style="white-space: nowrap; font-size: 0.75rem;">
                            <thead class="bg-primary text-white sticky-top" style="z-index: 1;">
                                <tr class="align-middle">
                                    <th class="bg-primary text-white">Action</th>
                                    <th class="bg-primary text-white">Date</th>
                                    <th class="bg-primary text-white">Invoice No</th>
                                    <th class="bg-primary text-white">Branch</th>
                                    <th class="bg-primary text-white">Department</th>
                                    <th class="bg-primary text-white">Cash Counter</th>
                                    <th class="bg-primary text-white">Mode</th>
                                    <th class="bg-primary text-white">Bank</th>
                                    <th class="bg-primary text-white">Sales Amount</th>
                                    <th class="bg-primary text-white">Total Amount</th>
                                </tr>
                            </thead>
                            <tbody id="listBody" class="table-group-divider"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white py-2">
                    <h6 class="modal-title">Confirm Delete</h6>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-0">Are you sure you want to delete this record?</p>
                </div>
                <div class="modal-footer py-1">
                    <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger btn-sm" id="confirmDeleteBtn">Yes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/pageAccess.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/cash-counter.js"></script>
</body>

</html>