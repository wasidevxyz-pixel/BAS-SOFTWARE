<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Registered Add/Update</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/desktop-style.css" rel="stylesheet">
    <link href="/css/sidebar.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @media screen {

            .print-grid,
            .print-value {
                display: none !important;
            }
        }

        .header-controls {
            background-color: #f8f9fa;
            padding: 4px;
            border: 1px solid #dee2e6;
            margin: 0 !important;
            border-bottom: none;
        }

        .info-bar {
            background-color: #007bff;
            color: white;
            padding: 4px 8px;
            font-size: 0.8rem;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .info-label {
            background: white;
            color: #007bff;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .table-container {
            background: white;
            border: 1px solid #dee2e6;
            border-top: none;
            overflow-x: auto;
        }

        .table {
            margin-bottom: 0;
            font-size: 0.7rem;
            white-space: nowrap;
            width: 100%;
        }

        .table thead th {
            background-color: #000 !important;
            color: #fff !important;
            padding: 8px 4px !important;
            border: 1px solid #666 !important;
            border-right: 1px solid #bbb !important;
            text-align: center;
            vertical-align: middle;
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        .table tbody td {
            padding: 2px 4px;
            border: 1px solid #bbb;
            vertical-align: middle;
        }

        .table tfoot td {
            background-color: #1e4c8c !important;
            color: #ffffff !important;
            font-weight: 800 !important;
            padding: 8px 4px !important;
            border: 1px solid #ffffff !important;
            font-size: 0.85rem !important;
            text-transform: uppercase;
        }

        /* Column Widths */
        .col-del {
            width: 30px;
        }

        .col-sr {
            width: 35px;
        }

        .col-date {
            width: 100px;
        }

        .col-time {
            width: 100px;
        }

        .col-diff-btns {
            width: 50px;
        }

        .col-diff-box {
            width: 90px;
        }

        .col-hrs {
            width: 75px;
        }

        .col-status {
            width: 140px;
        }

        /* Screen Header Grid */
        .header-grid {
            display: grid;
            grid-template-columns: 100px 180px 150px 1fr 180px 180px;
            border: 2px solid #333;
            margin-bottom: 20px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-box {
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
        }

        .header-box:last-child {
            border-right: none;
        }

        .header-label {
            font-weight: bold;
            font-size: 0.7rem;
            background: #eee;
            border-bottom: 1px solid #ddd;
            padding: 2px 5px;
            color: #555;
            text-transform: uppercase;
        }

        .header-box span:not(.header-label) {
            padding: 5px;
            font-weight: bold;
            font-size: 0.9rem;
            text-align: center;
            color: #000;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .company-section-screen {
            text-align: center;
            padding: 5px;
            border-right: 1px solid #ddd;
        }

        .company-section-screen h1 {
            margin: 0;
            font-size: 1.4rem;
            color: #000;
            font-family: 'Times New Roman', serif;
        }

        .company-section-screen h2 {
            margin: 0;
            font-size: 0.9rem;
            text-decoration: underline;
            font-weight: bold;
        }

        .company-section-screen p {
            margin: 0;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .no-print {
            display: flex;
        }

        @media print {
            .no-print {
                display: none !important;
            }
        }

        .diff-btns {
            display: flex;
            flex-direction: column;
            gap: 2px;
            align-items: center;
            justify-content: center;
        }

        .btn-diff {
            width: 24px;
            height: 18px;
            padding: 0;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            border: none;
            color: white;
            cursor: pointer;
        }

        .input-diff-box {
            width: 100%;
            height: 28px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            background-color: #f1f3f5;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .form-control-xs {
            height: 24px;
            font-size: 0.75rem;
            padding: 0 4px;
        }

        .row-completed td {
            background-color: #28a745 !important;
            /* Darker Green */
            color: #ffffff !important;
            font-weight: bold !important;
        }

        .row-partial td {
            background-color: #e2ec7a !important;
            /* Yellow */
            color: black !important;
            font-weight: bold !important;
        }

        .row-absent td {
            background-color: #f8d7da !important;
            /* Red */
            color: #721c24 !important;
            font-weight: bold !important;
        }

        .row-overtime td {
            background-color: #9d8df1 !important;
            /* Purple */
            color: white !important;
            font-weight: bold !important;
        }

        .row-warning td {
            background-color: #fd7e14 !important;
            /* Orange Warning */
            color: white !important;
            font-weight: bold !important;
        }

        .row-leave td {
            background-color: #fff3cd !important;
            /* Amber */
            color: #856404 !important;
            font-weight: bold !important;
        }

        .row-completed input,
        .row-completed select,
        .row-partial input,
        .row-partial select,
        .row-absent input,
        .row-absent select,
        .row-overtime input,
        .row-overtime select,
        .row-warning input,
        .row-warning select,
        .row-leave input,
        .row-leave select {
            background-color: white !important;
            color: black !important;
            border: 1px solid #ced4da !important;
        }

        .row-editing td {
            background-color: white !important;
            color: black !important;
            border: 1px solid #bbb !important;
        }

        .opacity-50 {
            opacity: 0.3;
        }

        /* Professional Print Styles - Matching Ref Image 2 */
        @media print {
            @page {
                size: portrait;
                margin: 0.25mm;
                /* Extremely minimal margin as requested */
            }

            .page-header,
            .header-controls,
            .btn,
            .col-del,
            .col-remarks,
            .col-diff-btns,
            .col-diffin,
            .col-diffout {
                display: none !important;
            }

            .container-fluid {
                padding: 0 !important;
            }

            .table-container {
                height: auto !important;
                overflow: visible !important;
                border: none !important;
                margin: 0 !important;
            }

            .row-present td,
            .row-absent td,
            .row-leave td {
                background-color: transparent !important;
                color: #000 !important;
                font-weight: normal !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            /* Force inputs/selects to be plain text black */
            .print-value {
                color: #000 !important;
                font-weight: normal !important;
            }

            table {
                width: 100% !important;
                border-collapse: collapse !important;
                font-size: 7.5pt !important;
                /* Increased font size for readability */
                font-family: 'Segoe UI', Arial, sans-serif !important;
                table-layout: fixed;
            }

            th,
            td {
                border: 1px solid #000 !important;
                padding: 4px 0px !important;
                /* increased padding */
                overflow: hidden;
                white-space: nowrap;
                line-height: 1.2 !important;
                /* normal line height */
                height: 29px;
                /* Reduced specific height to fit exactly on 1 page */
            }

            thead th {
                background-color: #000 !important;
                color: #fff !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                font-size: 8pt;
                font-weight: bold;
            }

            .print-grid {
                display: grid !important;
                grid-template-columns: 10% 12% 12% 43% 12% 11%;
                border: 2px solid #000;
                margin-bottom: 2px;
                /* Reduce gap */
                background: #fff;
            }

            .print-box {
                border-right: 1px solid #000;
                display: flex;
                flex-direction: column;
            }

            .print-box:last-child {
                border-right: none;
            }

            .print-label {
                font-weight: bold;
                font-size: 8pt;
                background: #eee;
                border-bottom: 1px solid #000;
                padding: 1px;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .print-box span:not(.print-label) {
                padding: 4px;
                font-weight: bold;
                font-size: 10pt;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .company-section {
                grid-column: 4;
                border-right: 1px solid #000;
                text-align: center;
                padding: 2px;
            }

            .company-section h1 {
                margin: 0;
                font-size: 20pt;
                font-family: 'Times New Roman', serif;
                font-weight: bold;
                line-height: 1.2;
            }

            .company-section h2 {
                margin: 2px 0;
                font-size: 14pt;
                text-decoration: underline;
                font-weight: bold;
            }

            .company-section p {
                margin: 1px 0;
                font-size: 10pt;
                font-weight: bold;
            }

            body,
            html,
            .table-container,
            .container-fluid {
                background-color: white !important;
            }

            /* Force Footer Bold and Professional */
            table tfoot,
            table tfoot tr,
            table tfoot td,
            .table tfoot td,
            .tfoot-bold,
            .tfoot-bold tr,
            .tfoot-bold td {
                font-weight: 900 !important;
                background: #eee !important;
                color: #000 !important;
                border: 1.5px solid #000 !important;
                text-align: center !important;
                font-size: 9pt !important;
                height: 35px !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            /* HIDE Actual Inputs/Selects in Print - Only show .print-value */
            input,
            select,
            .form-control,
            .form-select,
            .input-diff-box {
                display: none !important;
            }

            /* Show Text Values */
            .print-value {
                display: inline-block !important;
                color: #000 !important;
                font-weight: bold !important;
            }
        }

        .print-grid {
            display: none;
        }

        /* Lighter buttons for visibility on dark rows */
        .row-completed .btn-success,
        .row-partial .btn-success,
        .row-absent .btn-success,
        .row-overtime .btn-success,
        .row-warning .btn-success,
        .row-leave .btn-success {
            background-color: #51cf66 !important;
            border-color: #51cf66 !important;
        }

        .row-completed .btn-danger,
        .row-partial .btn-danger,
        .row-absent .btn-danger,
        .row-overtime .btn-danger,
        .row-warning .btn-danger,
        .row-leave .btn-danger {
            background-color: #ff6b6b !important;
            border-color: #ff6b6b !important;
        }

        .btn-delete {
            padding: 0;
            width: 20px;
            height: 20px;
            font-size: 10px;
            border-radius: 4px;
        }

        .info-badge-box {
            display: flex;
            align-items: center;
            background: #f1f3f5;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow: hidden;
            height: 30px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .info-badge-label {
            background: #1e4c8c;
            color: white;
            padding: 0 10px;
            font-size: 0.65rem;
            font-weight: 800;
            height: 100%;
            display: flex;
            align-items: center;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-badge-value {
            padding: 0 12px;
            font-weight: 700;
            font-size: 0.8rem;
            color: #333;
            background: white;
            height: 100%;
            display: flex;
            align-items: center;
            min-width: 40px;
        }

        /* Color variations for boxes */
        .box-name .info-badge-label {
            background: #1e4c8c;
        }

        .box-code .info-badge-label {
            background: #28a745;
        }

        .box-duty .info-badge-label {
            background: #fd7e14;
        }
    </style>
</head>

<body>
    <div class="print-grid">
        <div class="print-box">
            <span class="print-label">Code</span>
            <span id="pCodeGrid">-</span>
        </div>
        <div class="print-box">
            <span class="print-label">Employee</span>
            <span id="pNameGrid">-</span>
        </div>
        <div class="print-box">
            <span class="print-label">Branch</span>
            <span id="pBranchGrid">-</span>
        </div>
        <div class="company-section">
            <h1>Dwatson</h1>
            <h2>Employee Attendance Sheet</h2>
            <p id="pDateRangeGrid" style="margin:2px 0; font-weight:bold;"></p>
        </div>
        <div class="print-box">
            <span class="print-label">Department</span>
            <span id="pDeptGrid">-</span>
        </div>
        <div class="print-box">
            <span class="print-label">Designation</span>
            <span id="pDesigGrid">-</span>
        </div>
    </div>
    <div class="page-header px-3">
        <div style="flex: 1; display: flex; align-items: center;">
            <i class="fas fa-bars me-3" id="sidebarToggle" style="cursor:pointer; font-size: 1rem;"></i>
            Attendance Registered Add/Update
        </div>
        <div style="flex: 1; display: flex; justify-content: flex-end; align-items: center;">
            <div class="dropdown">
                <div class="d-flex align-items-center text-white" data-bs-toggle="dropdown" style="cursor: pointer;">
                    <i class="fas fa-user-circle me-2" style="font-size: 1.2rem;"></i>
                    <span id="userName" class="me-2">User</span>
                    <i class="fas fa-chevron-down" style="font-size: 0.7rem;"></i>
                </div>
                <ul class="dropdown-menu dropdown-menu-end shadow border-0">
                    <li><a class="dropdown-item py-2 logout-btn" href="#"><i
                                class="fas fa-sign-out-alt me-2 text-danger"></i>Sign Out</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container-fluid p-0">
        <div class="header-controls">
            <div class="d-flex gap-1 align-items-center flex-wrap">
                <label class="small fw-bold px-1">From</label>
                <input type="date" id="fromDate" class="form-control form-control-sm" style="width: 130px;">

                <label class="small fw-bold px-1">To</label>
                <input type="date" id="toDate" class="form-control form-control-sm" style="width: 130px;">

                <select id="filterBranch" class="form-select form-select-sm" style="width: 140px;" disabled>
                    <option value="">(PWD-1)</option>
                </select>

                <div class="d-flex align-items-center gap-1">
                    <button class="btn btn-success btn-sm px-2" onclick="loadEmployeeMonthData()"><i
                            class="fas fa-search"></i> Search</button>
                    <button class="btn btn-primary btn-sm px-2" onclick="saveAllVisible()"><i class="fas fa-save"></i>
                        Save</button>
                    <button class="btn btn-secondary btn-sm px-2" onclick="handlePrint()"><i class="fas fa-print"></i>
                        Print</button>
                    <button class="btn btn-danger btn-sm px-2" onclick="window.history.back()"><i
                            class="fas fa-arrow-left"></i> Back</button>
                </div>

                <div class="d-flex align-items-center gap-2 ms-auto">
                    <div class="info-badge-box box-name">
                        <div class="info-badge-label">Name</div>
                        <div id="dispEmpName" class="info-badge-value">-</div>
                    </div>

                    <div class="info-badge-box box-code">
                        <div class="info-badge-label">Code</div>
                        <div id="dispEmpCode" class="info-badge-value">-</div>
                    </div>

                    <div class="info-badge-box box-duty">
                        <div class="info-badge-label">Duty Hrs</div>
                        <div id="dispDutyHrs" class="info-badge-value">-</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-container">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th class="col-del" style="width: 30px;">X</th>
                        <th class="col-sr" style="width: 40px;">SrNo</th>
                        <th class="col-date" style="width: 100px;">Dated</th>
                        <th style="width: 80px;">Day</th>
                        <th style="width: 80px;">Check In</th>
                        <th style="width: 80px;">Check Out</th>
                        <th style="width: 70px;">Worked Hrs</th>
                        <th style="width: 80px;">Break Out</th>
                        <th style="width: 80px;">Break In</th>
                        <th style="width: 70px;">Total Brk Hrs</th>
                        <th class="col-diff-btns" style="width: 45px;">Diff</th>
                        <th class="col-diffin" style="width: 80px;">Time Diff In</th>
                        <th class="col-diffout" style="width: 80px;">Time Diff Out</th>
                        <th style="width: 70px;">Total Diff</th>
                        <th style="width: 70px;">Total Hours</th>
                        <th class="col-status" style="width: 70px;">Status</th>
                        <th class="col-remarks">Remarks</th>
                    </tr>
                </thead>
                <tbody id="detailRecordsBody">
                    <!-- Dynamic Rows -->
                </tbody>
                <tfoot class="tfoot-bold">
                    <tr>
                        <td class="col-del"></td>
                        <td colspan="5" class="text-center" style="font-weight:bold;">Total</td>
                        <td id="tWorkedHrs" class="text-center">00:00</td>
                        <td colspan="2"></td>
                        <td id="tBreakHrs" class="text-center">00:00</td>
                        <td class="col-diff-btns"></td>
                        <td class="col-diffin"></td>
                        <td class="col-diffout"></td>
                        <td id="tDiffHrs" class="text-center">00:00</td>
                        <td id="tFinalHrs" class="text-center">00:00</td>
                        <td colspan="2"></td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/pageAccess.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/employee-attendance-detail.js"></script>
</body>

</html>